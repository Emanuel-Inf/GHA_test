name: Simple Workflow

on:
  push:
    branches:
      - main

jobs:
  job1:
    runs-on: ubuntu-latest
    outputs:
      matrix: ${{ steps.set-matrix.outputs.matrix }}  # Der Job gibt die Matrix aus

    steps:
      - id: set-matrix
        run: |
          #testmatrix='{"group1":[\"item1\", \"items2\"], "group2":[\"item1\", \"items2\", \"items3\"], "group3":[\"item1\", \"items2\", \"items3\", \"items4\"], "group4":[\"item1\", \"items2\", \"item3\", \"items4\", \"item5\", \"items6\"]}'
          #matrix={\"include\":[{\"project\":\"foo\",\"config\":\"Debug\"},{\"project\":\"bar\",\"config\":\"Release\"}]} >> $GITHUB_OUTPUT
          testmatrix='{
            "group1": ["item1", "items2"],
            "group2": ["item1", "items2", "items3"],
            "group3": ["item1", "items2", "items3", "items4"],
            "group4": ["item1", "items2", "item3", "items4", "item5", "items6"]
          }'
          
          echo "$testmatrix"
          
          matrix_str=$(echo "$testmatrix" | jq -c .)  

          echo "$matrix_str"
          echo "matrix=$matrix_str" >> "$GITHUB_OUTPUT"  

  job2: 
    runs-on: ubuntu-latest
    needs: job1  
    steps:
      - run: |
      
         # Speichern der Matrix in einer Variablen
         # MATRIX="${{ needs.job1.outputs.matrix }}"
          MATRIX='{"group1":["item1","items2"],"group2":["item1","items2","items3"],"group3":["item1","items2","items3","items4"],"group4":["item1","items2","item3","items4","item5","items6"]}'
          echo "The stored matrix is: $MATRIX"

          SECOND_OBJECT=$(echo "$MATRIX" | jq -r '.group2')  
          echo "The second object in group2 is: $SECOND_OBJECT"